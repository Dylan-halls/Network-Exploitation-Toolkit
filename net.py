#!/usr/bin/env python3 
import os, sys, time, multiprocessing
from threading import Thread

try:
   from scapy.all import *
except ImportError:
   ins = input("Install Scapy?[Y/N]: ").lower()
   if ins == y:
      os.system("sudo pip3 install scapy-python3")
   else: pass

try:
   from termcolor import colored
except ImportError:
   inst = input("Install Termcolor?[Y/N]: ").lower()
   if inst == y:
      os.system("sudo pip3 install termcolor")
   else: pass

os.system("clear")

try:
   p1 = os.path.abspath("MITM_DNS")
   print("[+] Found ", p1)
except:
   print("[-] Could not find ", p1, "... Exiting")
   exit(-1)

try:
   p2 = os.path.abspath("MITM_ICMP")
   print("[+] Found ", p2)
except:
   print("[-] Could not find ", p2, "... Exiting")
   exit(-1)

try:
   p3 = os.path.abspath("MITM_IP")
   print("[+] Found ", p3)
except:
   print("[-] Could not find ", p3, "... Exiting")
   exit(-1)

try:
   p4 = os.path.abspath("MITM_TCP")
   print("[+] Found ", p4)
except:
   print("\n[-] Could not find ", p4, "... Exiting")
   exit(-1)

try:
   p5 = os.path.abspath("MITM_UDP")
   print("[+] Found ", p5)
except:
   print("[-] Could not find ", p5, "... Exiting")
   exit(-1)

try:
   p6 = os.path.abspath("ARP_DNS")
   print("[+] Found ", p6)
except:
   print("[-] Could not find ", p6, "... Exiting")
   exit(-1)

try:
   p7 = os.path.abspath("ARP_ICMP")
   print("[+] Found ", p7)
except:
   print("[-] Could not find ", p7, "... Exiting")
   exit(-1)

try:
   p8 = os.path.abspath("ARP_IP")
   print("[+] Found ", p8)
except:
   print("[-] Could not find ", p8, "... Exiting")
   exit(-1)

try:
   p9 = os.path.abspath("ARP_TCP")
   print("[+] Found ", p9)
except:
   print("[-] Could not find ", p9, "... Exiting")
   exit(-1)

try:
   p10 = os.path.abspath("ARP_UDP.py")
   print("[+] Found ", p10)
except:
   print("[-] Could not find ", p10, "... Exiting")
   exit(-1)

try:
   p11 = os.path.abspath("ARP_UDP.py")
   print("[+] Found ", p11)
except:
   print("[-] Could not find ", p11, "... Exiting")
   exit(-1)

try:
   p12 = os.path.abspath("Sniffer.py")
   print("[+] Found ", p12)
except:
   print("[-] Could not find ", p12, "... Exiting")
   exit(-1)

try:
   p12 = os.path.abspath("Sniffer.py")
   print("[+] Found ", p12)
except:
   print("[-] Could not find ", p12, "... Exiting")
   exit(-1)

os.system("clear")

print("""
                    _______  ______________________
                    \      \ \_   _____/\__    ___/
                    /   |   \ |    __)_   |    |   
                   /    |    \|        \  |    |   
                   \____|__  /_______  /  |____|   
                           \/        \/            
 
                  ------------------------------
                   Network Exploitation Toolkit

              #######################################
              #                                     #
              #   Author: Dylan Halls               #
              #   Email: Dylan.halls123@gmail.com   #
              #   FaceBook: Dylan Halls             #
              #   Instagram: Dylan.halls            #
              #                                     #
              ######################################
""")
print("\nOptions:")
print("1      -       Packet Blocker")
print("2      -       Packet Sniffer")
print("3      -       ARP M-I-T-M")

try:
   ch = input("\nOption: ")
except KeyboardInterrupt:
   os.system("python3 net.py")

if ch == '1':
   os.system("clear")
   print("""
      __________ __      __    __________.__                 __    
      \______   \  | ___/  |_  \______   \  |   ____   ____ |  | __
       |     ___/  |/ /\   __\  |    |  _/  |  /  _ \_/ ___\|  |/ /
       |    |   |    <  |  |    |    |   \  |_(  <_> )  \___|    < 
       |____|   |__|_ \ |__|    |______  /____/\____/ \___  >__|_ \ 
                     \/                \/                 \/     \/ """)
   
   print("Options:\n")
   print("        1      -      TCP")
   print("        2      -      DNS")
   print("        3      -      UDP")
   print("        4      -      IP")
   print("        5      -      ICMP")
   try:
       pro = input("\nOption:")
   except KeyboardInterrupt:
       os.system("{ python3 net.py; }")
       exit(0)
   if pro == '1':
	     os.system("{ cd PacketBlocker; python3 ARP_TCP.py; }")
   elif pro == '2':
	     os.system("{ cd PacketBlocker; python3 ARP_DNS.py; }")
   elif pro == '3':
	   os.system("{ cd PacketBlocker; python3 ARP_UDP.py; }")
   elif pro == '4':
	   os.system("{ cd PacketBlocker; python3 ARP_IP.py; }")
   elif pro == '5':
	    os.system("{ cd PacketBlocker; python3 ARP_ICMP.py; }")


elif ch == '2':
   os.system("clear")
   fi = input("Save output to file?: ")
   if fi == 'y' or 'yes':
      jobs = []
      p = multiprocessing.Process(target=Sniffing)
      jobs.append(p)
      p.start()
      while True:
         seq = ["Sniffing |", "Sniffing /", "Sniffing -", "Sniffing \\"] 
         for word in seq:
            sys.stdout.write("\r{}".format(word))
            sys.stdout.flush
            time.sleep(0.5)
      _thread.start_new_thread( os.system("{ cd PacketSniffer; python3 Sniffer.py > Sniffer.txt; }") )
      
   else:
      os.system("{ cd PacketSniffer; python3 Sniffer.py; }")
   
elif ch == '3':
  os.system("clear")
  print("""
      

   _____ ____________________     _____  .___________________   
  /  _  \ ______   \______   \   /     \ |   \__    ___/     \  
 /  /_\  \|       _/|     ___/  /  \ /  \|   | |    | /  \ /  \ 
/    |    \    |   \|    |     /    Y    \   | |    |/    Y    )
\____|__  /____|_  /|____|     \____|__  /___| |____|\____|__  /
        \/       \/                    \/                    \/ 

       """)
  print("Options:\n ")
  print("        1      -      TCP")
  print("        2      -      DNS")
  print("        3      -      UDP")
  print("        4      -      IP")
  print("        5      -      ICMP")
  try:
     pro = input("\nOption: ")
  except KeyboardInterrupt:
     os.system("{ python3 net.py; }")
     exit(0)
  if pro == '1':
     os.system("{ cd Man_In_The_Middle; python3 MITM_TCP.py; }")
  elif pro == '2':
     os.system("{ cd Man_In_The_Middle; python3 MITM_DNS.py; }")
  elif pro == '3':
    os.system("{ cd Man_In_The_Middle; python3 MITM_UDP.py; }")
  elif pro == '4':
    os.system("{ cd Man_In_The_Middle; python3 MITM_IP.py; }")
  elif pro == '5':
    os.system("{ cd Man_In_The_Middle; python3 MITM_ICMP.py; }")


elif ch == 'Quit':
   exit(1)
