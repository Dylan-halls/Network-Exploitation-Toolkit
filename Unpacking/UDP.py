from scapy.all import *
from termcolor import colored

def pkthandler(pkt):
   try:
      ip = pkt[IP]
   except IndexError:
      pass

   try:
      src = ip.src
      dst = ip.dst
   except UnboundLocalError:
      pass

   if pkt.haslayer(UDP):
      udp = pkt[UDP]

      print("--------------------------------------------------------\n\n")
      print("                     .:{}:.                            ".format(colored('UDP','red')))
      print("                                                          ")
      print("  \033[1;36mSource IP:\033[00m {} \033[1;36mDestination IP:\033[00m {}".format(src, dst))
      print("  \033[1;36mSource Port:\033[00m {} \033[1;36mDestination Port:\033[00m {}".format(udp.sport, udp.dport))
      print("  \033[1;36mLength:\033[00m {}                         ".format(udp.len))
      print("  \033[1;36mChecksum:\033[00m {}                         ".format(udp.chksum))
      rawLoad = pkt.getlayer(Raw)
      if rawLoad == None: pass
      else:
         print("  \033[1;36mRaw:\n\n\033[00m {}                         ".format(rawLoad))

      print(" ")
      print(" ")
      hexdump(pkt)

      

pkt = sniff(iface='wlan0' ,prn=pkthandler)