#! /usr/bin/env python3
from multiprocessing.dummy import Pool
from termcolor import colored
import itertools
import argparse
import socket

def scan(addr):
    try:
        print("\033[1;94m[+]\033[00m", addr, socket.gethostbyaddr(addr)[0])
        return("\033[1;94m[+]\033[00m", addr, socket.gethostbyaddr(addr)[0])
    except socket.herror:
        return
    except KeyboardInterrupt:
        return
    except Exception as error:
        print(type(error), error)

address = str(input ("Address Range: "))
pro = int(input("Processes: "))
fil = str(input("Output File: "))
print("\n")

try:
    int(pro)
except:
    raise 'Processes must be a number'
    exit(0)

addr = address.replace('*', '%s')
addrs = [addr % i for i in itertools.product(range(255), repeat=addr.count('%s'))]

if __name__=='__main__':
    pool = Pool(pro)
    result=[i for i in pool.map(scan, addrs) if i]
    with open(fil, 'w') as file:
       file.write('\n'.join([i[0]+' '+i[1] for i in result]))
    
